---
- job:
    name: neutron-operator-tempest-multinode
    parent: podified-multinode-edpm-deployment-crc
    dependencies: ["openstack-k8s-operators-content-provider"]
    irrelevant-files:
      - .*/*.md
      - ^.github/.*$
      - .ci-operator.yaml
      - .dockerignore
      - .gitignore
      - .golangci.yaml
      - .pre-commit-config.yaml
      - .prow_ci.env
      - ^LICENSE.*$
      - ^OWNERS$
      - ^OWNERS_ALIASES$
      - ^PROJECT$
      - .*go.(mod|sum|work).*
      - ^kuttl-test.yaml$
      - ^renovate.json$
      - ^config/samples/.*$
      - ^docs?/.*
      - ^hack/.*$
      - ^tests?/functional/.*$
      - ^tests?/kuttl/.*$
      - ^zuul.d/jobs.yaml
    vars:
      cifmw_install_yamls_vars_patch_openstack_img:
        OPENSTACK_IMG: quay.io/rh-ee-vfisarov/openstack-operator-index:appcred-support-latest
      cifmw_edpm_prepare_kustomizations:
        - apiVersion: kustomize.config.k8s.io/v1beta1
          kind: Kustomization
          namespace: openstack
          patches:
          - patch: |-
              apiVersion: core.openstack.org/v1beta1
              kind: OpenStackControlPlane
              metadata:
                name: unused
              spec:
                applicationCredential:
                  enabled: true
                barbican:
                  applicationCredential:
                    enabled: true
                cinder:
                  applicationCredential:
                    enabled: true
                glance:
                  applicationCredential:
                    enabled: false
                swift:
                  applicationCredential:
                    enabled: true
                neutron:
                  applicationCredential:
                    enabled: true
                placement:
                  applicationCredential:
                    enabled: true
                nova:
                  applicationCredential:
                    enabled: true
                telemetry:
                  applicationCredentialCeilometer:
                    enabled: true
            target:
              kind: OpenStackControlPlane
      cifmw_edpm_deploy_nova_compute_extra_config: |
        [DEFAULT]
        force_config_drive = false
      cifmw_test_operator_tempest_container: openstack-tempest-all
      cifmw_run_test_role: test_operator
      cifmw_test_operator_tempest_network_attachments:
        - ctlplane
      cifmw_test_operator_tempest_tempestconf_config:
          overrides: |
            compute-feature-enabled.vnc_console true
            validation.run_validation true
            identity.v3_endpoint_type public
            identity.v2_admin_endpoint_type public
      cifmw_test_operator_tempest_include_list: |
        neutron_tempest_plugin.api
        neutron_tempest_plugin.scenario
        # To check metadata with and without config drive
        tempest.scenario.test_server_basic_ops.TestServerBasicOps.test_server_basic_ops
      cifmw_test_operator_tempest_exclude_list: |
        # https://review.opendev.org/892839
        neutron_tempest_plugin.scenario.test_mtu.NetworkWritableMtuTest
        # missing https://review.opendev.org/882818 in antelope
        test_qos_dscp_create_and_update
        # Limit job runtime
        NetworkSecGroupTest
